# Where: tests/.env.test
# What: E2E test environment variables for run_tests.py and compose.
# Why: Provide deterministic defaults for local testing.
#
# E2Eテスト用環境変数
# run_tests.py によって読み込まれます

# ESB CLI 設定
ESB_TEMPLATE=tests/fixtures/template.yaml

# 認証情報
AUTH_USER=test-admin
AUTH_PASS=test-secure-password
JWT_SECRET_KEY=test-secret-key-must-be-at-least-32-chars
X_API_KEY=test-api-key

# ネットワーク設定
CONTAINERS_NETWORK=test-network
LAMBDA_NETWORK=test-internal-network
EXTERNAL_NETWORK=test-external
GATEWAY_INTERNAL_URL=https://10.99.0.1:443
WG_CONTROL_NET=10.99.0.0/24
WG_CONTROL_GW_HOST=gateway
AGENT_GRPC_ADDRESS=localhost:50051
CNI_SUBNET=10.88.1.0/24
CNI_SUBNET=10.88.1.0/24
GATEWAY_WORKER_ROUTE_VIA_HOST=runtime-node
# Disable vsock requirement for E2E tests (run in containers)
VHOST_VSOCK_REQUIRED=0

# その他
LOG_LEVEL=DEBUG
VICTORIALOGS_PORT=9428
VICTORIALOGS_URL=http://10.88.0.1:9428
GATEWAY_VICTORIALOGS_URL=http://victorialogs:9428
VICTORIALOGS_QUERY_URL=http://localhost:9428
GATEWAY_PORT=443
SCYLLADB_PORT=8001
RUSTFS_API_PORT=9000

# Storage Credentials
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin

# Operational Settings
IDLE_TIMEOUT_MINUTES=5
CONTAINER_CACHE_TTL=30
SCYLLADB_MEMORY=1
RUSTFS_DEDUPLICATION=true
RUSTFS_COMPRESSION=auto

# Server & Workers
UVICORN_WORKERS=4
UVICORN_BIND_ADDR=0.0.0.0:8000
JWT_EXPIRES_DELTA=3000

# Timeouts
LAMBDA_INVOKE_TIMEOUT=30.0
PING_TIMEOUT=1.0

# Circuit Breaker (E2E short settings)
CIRCUIT_BREAKER_THRESHOLD=3
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=10.0

# Gateway Config Paths
GATEWAY_FUNCTIONS_YML=./tests/fixtures/.esb/config/functions.yml
GATEWAY_ROUTING_YML=./tests/fixtures/.esb/config/routing.yml

# Phase 5 Step 0: Local Registry Integration
# CONTAINER_REGISTRY is intentionally omitted for registry-free Docker mode.
# Non-Docker modes will override this in their environment-specific files.
ESB_CERT_DIR=~/.esb/certs
