# =============================================================================
# Edge Serverless Box - 環境変数テンプレート
# =============================================================================
# 使用方法: cp .env.example .env
# .env はGitにコミットされません（.gitignoreに登録済み）

# =============================================================================
# Security (必須) - 本番環境では必ず変更してください
# =============================================================================
JWT_SECRET_KEY=your-production-jwt-secret-key-min-32-chars
X_API_KEY=your-production-api-key
AUTH_USER=admin
AUTH_PASS=your-secure-password-change-in-production

# =============================================================================
# Storage Credentials (必須) - 本番環境では必ず変更してください
# =============================================================================
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin

# =============================================================================
# Networking (必須) - 環境依存パラメータ
# =============================================================================
# NOTE: CONTAINERS_NETWORK は LAMBDA_NETWORK と同じ値にするのが基本
LAMBDA_NETWORK=onpre-internal-network
EXTERNAL_NETWORK=onpre-external
CONTAINERS_NETWORK=onpre-internal-network
# Lambda -> Gateway (CNI bridge のデフォルト: 10.88.0.1)
GATEWAY_INTERNAL_URL=https://10.88.0.1:443

# =============================================================================
# Ports (公開ポート設定)
# =============================================================================
GATEWAY_PORT=443
REGISTRY_PORT=5010
RUSTFS_API_PORT=9000
RUSTFS_CONSOLE_PORT=9001
SCYLLADB_PORT=8001
VICTORIALOGS_PORT=9428

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=INFO
# VICTORIALOGS_URL=http://10.88.0.1:9428
# VICTORIALOGS_HOST=victorialogs
# LOG_CONFIG_PATH=/app/config/gateway_log.yaml
# VERIFY_SSL=false
# PYTHONUNBUFFERED=1

# =============================================================================
# Gateway Settings
# =============================================================================
USE_GRPC_AGENT=true
AGENT_GRPC_ADDRESS=localhost:50051
UVICORN_WORKERS=4
UVICORN_BIND_ADDR=0.0.0.0:8000
JWT_EXPIRES_DELTA=3000
AUTH_ENDPOINT_PATH=/user/auth/v1
ENABLE_SSL=true
SSL_CERT_PATH=/app/config/ssl/server.crt
SSL_KEY_PATH=/app/config/ssl/server.key
LAMBDA_PORT=8080
LAMBDA_INVOKE_TIMEOUT=30.0
READINESS_TIMEOUT=30
DOCKER_DAEMON_TIMEOUT=30
MAX_CONCURRENT_REQUESTS=10
QUEUE_TIMEOUT_SECONDS=10
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30.0

# =============================================================================
# Auto-Scaling
# =============================================================================
DEFAULT_MAX_CAPACITY=1
DEFAULT_MIN_CAPACITY=0
POOL_ACQUIRE_TIMEOUT=30.0
HEARTBEAT_INTERVAL=30
GATEWAY_IDLE_TIMEOUT_SECONDS=300
ENABLE_CONTAINER_PAUSE=false
PAUSE_IDLE_SECONDS=30
ORPHAN_GRACE_PERIOD_SECONDS=60
CONTAINER_CACHE_TTL=30

# =============================================================================
# Agent Settings
# =============================================================================
AGENT_RUNTIME=containerd
PORT=50051
CONTAINER_REGISTRY=localhost:5010
# CNI_CONF_DIR=/etc/cni/net.d
# CNI_CONF_FILE=/etc/cni/net.d/10-esb.conflist
# CNI_BIN_DIR=/opt/cni/bin

# =============================================================================
# Storage Settings
# =============================================================================
RUSTFS_DEDUPLICATION=true
RUSTFS_COMPRESSION=auto
SCYLLADB_MEMORY=1

# =============================================================================
# Paths (host/container)
# =============================================================================
GATEWAY_FUNCTIONS_YML=./config/functions.yml
GATEWAY_ROUTING_YML=./config/routing.yml
ESB_CERT_DIR=~/.esb/certs
# ROUTING_CONFIG_PATH=/app/config/routing.yml
# FUNCTIONS_CONFIG_PATH=/app/config/functions.yml
# DATA_ROOT_PATH=/data
# LOGS_ROOT_PATH=/logs

# =============================================================================
# CLI/Test Helpers (optional)
# =============================================================================
# ESB_TEMPLATE=tests/fixtures/template.yaml
