#
# Where: .env.example
# What: Environment variable template for local/dev setups.
# Why: Provide a safe baseline for required configuration.
#
# =============================================================================
# Edge Serverless Box - 環境変数テンプレート
# =============================================================================
# 使用方法: cp .env.example .env
# .env はGitにコミットされません（.gitignoreに登録済み）

# =============================================================================
# Security (必須) - 本番環境では必ず変更してください
# =============================================================================
JWT_SECRET_KEY=your-production-jwt-secret-key-min-32-chars
X_API_KEY=your-production-api-key
AUTH_USER=admin
AUTH_PASS=your-secure-password-change-in-production

# =============================================================================
# Storage Credentials (必須) - 本番環境では必ず変更してください
# =============================================================================
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin

# =============================================================================
# Networking (必須) - 環境依存パラメータ
# =============================================================================
# 外部公開用ネットワーク名
ESB_NETWORK_EXTERNAL=esb-external-network
# コンテナ間通信のサブネット (docker-compose.ymlのdefault準拠)
# ESB_SUBNET_EXTERNAL=172.50.0.0/16

# Data Plane Host (Containerd Mode: 10.88.0.1 / Docker Mode: esb-s3-storage etc.)
ESB_DATA_PLANE_HOST=10.88.0.1

# =============================================================================
# Ports (公開ポート設定)
# =============================================================================
GATEWAY_PORT=443
REGISTRY_PORT=5010
RUSTFS_API_PORT=9000
RUSTFS_CONSOLE_PORT=9001
SCYLLADB_PORT=8001
VICTORIALOGS_PORT=9428

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=INFO
# VICTORIALOGS_URL=http://10.88.0.1:9428
# VICTORIALOGS_HOST=victorialogs
# LOG_CONFIG_PATH=/app/config/gateway_log.yaml
# VERIFY_SSL=false
# PYTHONUNBUFFERED=1

# =============================================================================
# Gateway Settings
# =============================================================================
USE_GRPC_AGENT=true
AGENT_GRPC_ADDRESS=localhost:50051
UVICORN_WORKERS=4
UVICORN_BIND_ADDR=0.0.0.0:8000
JWT_EXPIRES_DELTA=3000
AUTH_ENDPOINT_PATH=/user/auth/v1
ENABLE_SSL=true
SSL_CERT_PATH=/app/config/ssl/server.crt
SSL_KEY_PATH=/app/config/ssl/server.key
LAMBDA_PORT=8080
LAMBDA_INVOKE_TIMEOUT=30.0
READINESS_TIMEOUT=30
DOCKER_DAEMON_TIMEOUT=30
MAX_CONCURRENT_REQUESTS=10
QUEUE_TIMEOUT_SECONDS=10
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30.0

# =============================================================================
# Auto-Scaling
# =============================================================================
DEFAULT_MAX_CAPACITY=1
DEFAULT_MIN_CAPACITY=0
POOL_ACQUIRE_TIMEOUT=30.0
HEARTBEAT_INTERVAL=30
GATEWAY_IDLE_TIMEOUT_SECONDS=300
ENABLE_CONTAINER_PAUSE=false
PAUSE_IDLE_SECONDS=30
ORPHAN_GRACE_PERIOD_SECONDS=60
CONTAINER_CACHE_TTL=30

# =============================================================================
# Agent Settings
# =============================================================================
AGENT_RUNTIME=containerd
PORT=50051
CONTAINER_REGISTRY=localhost:5010
# CNI_CONF_DIR=/etc/cni/net.d
# CNI_CONF_FILE=/etc/cni/net.d/10-esb.conflist
# CNI_BIN_DIR=/opt/cni/bin
# CNI_SUBNET=10.88.1.0/24

# =============================================================================
# Storage Settings
# =============================================================================
RUSTFS_DEDUPLICATION=true
RUSTFS_COMPRESSION=auto
SCYLLADB_MEMORY=1

# =============================================================================
# Paths (host/container)
# =============================================================================
GATEWAY_FUNCTIONS_YML=./config/functions.yml
GATEWAY_ROUTING_YML=./config/routing.yml
ESB_CERT_DIR=~/.esb/certs
# WireGuard config for gateway (Phase C L3)
# ESB_WG_GATEWAY_CONF=~/.esb/wireguard/gateway/wg0.conf
# WireGuard MTU (lower if TLS stalls over WG in WSL/Hyper-V)
# ESB_WG_MTU=1340
# WG mode (Phase C): Gateway internal URL over wg0
# GATEWAY_INTERNAL_URL=https://10.99.0.1:443
# Local worker route override (development/testing only)
# GATEWAY_WORKER_ROUTE_VIA_HOST=runtime-node
# GATEWAY_WORKER_ROUTE_VIA=172.30.0.5
# GATEWAY_WORKER_ROUTE_CIDR=10.88.0.0/16
# Runtime-node fixed IP on compute plane
# RUNTIME_NODE_IP=172.20.0.10
# RUNTIME_NET_SUBNET=172.20.0.0/16
# Control host/IP for compute nodes (registry/s3/db/logs/gateway)
# ESB_CONTROL_HOST=10.0.0.10
# WG control network route inside runtime-node
# WG_CONTROL_NET=10.99.0.0/24
# WG_CONTROL_GW_HOST=gateway
# ROUTING_CONFIG_PATH=/app/config/routing.yml
# FUNCTIONS_CONFIG_PATH=/app/config/functions.yml
# DATA_ROOT_PATH=/data
# LOGS_ROOT_PATH=/logs

# =============================================================================
# CLI/Test Helpers (optional)
# =============================================================================
# ESB_TEMPLATE=tests/fixtures/template.yaml
