# Auto-generated by SAM Template Generator
# DO NOT EDIT MANUALLY - Regenerate with: esb deploy

defaults:
  environment:
    GATEWAY_INTERNAL_URL: "${GATEWAY_INTERNAL_URL}"
    LOG_LEVEL: "${LOG_LEVEL}"
    AWS_ACCESS_KEY_ID: "${RUSTFS_ACCESS_KEY}"
    AWS_SECRET_ACCESS_KEY: "${RUSTFS_SECRET_KEY}"
    AWS_DEFAULT_REGION: "ap-northeast-1"
  scaling:
    idle_timeout: 300
    acquire_timeout: 30.0

functions:
  lambda-chaos:
    image: "127.0.0.1:5010/esb-lambda-chaos:e2e-docker-latest"
    timeout: 30
    memory_size: 128
  lambda-connectivity:
    image: "127.0.0.1:5010/esb-lambda-connectivity:e2e-docker-latest"
    timeout: 30
    memory_size: 128
  lambda-connectivity-java:
    image: "127.0.0.1:5010/esb-lambda-connectivity-java:e2e-docker-latest"
    timeout: 30
    memory_size: 512
    environment:
      DYNAMODB_ENDPOINT: "http://database:8000"
      E2E_TABLE_NAME: "e2e-test-table"
      S3_ENDPOINT: "http://s3-storage:9000"
  lambda-dynamo:
    image: "127.0.0.1:5010/esb-lambda-dynamo:e2e-docker-latest"
    timeout: 30
    memory_size: 128
    environment:
      DYNAMODB_ENDPOINT: "http://database:8000"
  lambda-echo:
    image: "127.0.0.1:5010/esb-lambda-echo:e2e-docker-latest"
    timeout: 30
    memory_size: 128
    scaling:
      max_capacity: 1
      min_capacity: 1
  lambda-echo-java:
    image: "127.0.0.1:5010/esb-lambda-echo-java:e2e-docker-latest"
    timeout: 30
    memory_size: 128
  lambda-image:
    image: "127.0.0.1:5010/esb-lambda-image:e2e-docker-latest"
    timeout: 30
    memory_size: 512
  lambda-integration:
    image: "127.0.0.1:5010/esb-lambda-integration:e2e-docker-latest"
    timeout: 30
    memory_size: 128
  lambda-s3:
    image: "127.0.0.1:5010/esb-lambda-s3:e2e-docker-latest"
    timeout: 30
    memory_size: 128
    environment:
      RUSTFS_ROOT_PASSWORD: "rustfsadmin"
      RUSTFS_ROOT_USER: "rustfsadmin"
      S3_ENDPOINT: "http://s3-storage:9000"
  lambda-scaling:
    image: "127.0.0.1:5010/esb-lambda-scaling:e2e-docker-latest"
    timeout: 30
    memory_size: 128
    scaling:
      max_capacity: 3
  lambda-scheduled:
    image: "127.0.0.1:5010/esb-lambda-scheduled:e2e-docker-latest"
    timeout: 30
    memory_size: 128
    environment:
      DYNAMODB_ENDPOINT: "http://database:8000"
    events:
      - schedule:
          rate: "rate(1 minute)"
          input: "{\"scheduled\": true}"
