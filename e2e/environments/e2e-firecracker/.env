# E2Eテスト用環境変数 (Firecracker)
# 各プロファイルで完備された設定を持ち、shared .env.test への依存を排除します

# ESB CLI 設定
ESB_TEMPLATE=tests/fixtures/template.yaml

# 認証情報
AUTH_USER=test-admin
AUTH_PASS=test-secure-password
JWT_SECRET_KEY=test-secret-key-must-be-at-least-32-chars
X_API_KEY=test-api-key

# ネットワーク設定
CONTAINERS_NETWORK=test-network
LAMBDA_NETWORK=test-internal-network
EXTERNAL_NETWORK=test-external
GATEWAY_INTERNAL_URL=https://gateway:443
CONTAINERD_RUNTIME=aws.firecracker
WG_CONTROL_NET=10.99.0.0/24
WG_CONTROL_GW_HOST=gateway
# AGENT_GRPC_ADDRESS は動的割り当て（ports.json経由）
CNI_SUBNET=10.88.1.0/24
GATEWAY_WORKER_ROUTE_VIA_HOST=runtime-node
VHOST_VSOCK_REQUIRED=0

# その他
LOG_LEVEL=DEBUG

# ポートは動的割り当て（docker compose起動後に自動設定）
# 固定したい場合は以下のコメントを外してください
# ESB_PORT_GATEWAY_HTTPS=443
# ESB_PORT_AGENT_GRPC=50051
# ESB_PORT_REGISTRY=5010
# ESB_PORT_S3=9000
# ESB_PORT_S3_MGMT=9001
# ESB_PORT_DATABASE=8001
# ESB_PORT_VICTORIALOGS=9428

# Storage Credentials
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin

# Operational Settings
IDLE_TIMEOUT_MINUTES=1
CONTAINER_CACHE_TTL=30
SCYLLADB_MEMORY=1
RUSTFS_DEDUPLICATION=true
RUSTFS_COMPRESSION=auto

# Server & Workers
UVICORN_WORKERS=4
UVICORN_BIND_ADDR=0.0.0.0:8000
JWT_EXPIRES_DELTA=3000

# Timeouts
LAMBDA_INVOKE_TIMEOUT=30.0
PING_TIMEOUT=1.0

# Circuit Breaker (E2E short settings)
CIRCUIT_BREAKER_THRESHOLD=3
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=10.0

# Paths & Workspace
CERT_DIR=./.<brand>/certs

# Profile Specific Overrides (Autoscaling specialized)
DEFAULT_MAX_CAPACITY=3
DEFAULT_MIN_CAPACITY=0
POOL_ACQUIRE_TIMEOUT=60.0
HEARTBEAT_INTERVAL=2
GATEWAY_IDLE_TIMEOUT_SECONDS=30
PORT_REGISTRY=0
CONTAINER_REGISTRY=registry:5010
